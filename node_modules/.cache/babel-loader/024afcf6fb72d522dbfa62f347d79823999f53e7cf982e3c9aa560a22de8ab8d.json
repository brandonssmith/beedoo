{"ast":null,"code":"var _jsxFileName = \"C:\\\\Code\\\\beedoo\\\\src\\\\components\\\\RichTextEditor.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$(),\n  _s4 = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { LexicalComposer } from '@lexical/react/LexicalComposer';\nimport { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin';\nimport { ContentEditable } from '@lexical/react/LexicalContentEditable';\nimport { HistoryPlugin } from '@lexical/react/LexicalHistoryPlugin';\nimport { AutoFocusPlugin } from '@lexical/react/LexicalAutoFocusPlugin';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\nimport { $getRoot, $getSelection, $isRangeSelection } from 'lexical';\nimport { Bold, Italic, Underline, List, Link, AlignLeft, AlignCenter, AlignRight, Heading1, Heading2, Heading3 } from 'lucide-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst IMAGE_UPLOAD_ENDPOINT = '/.netlify/functions/upload-image';\n\n// Custom onChange plugin\nfunction CustomOnChangePlugin({\n  onChange\n}) {\n  _s();\n  const [editor] = useLexicalComposerContext();\n  useEffect(() => {\n    return editor.registerUpdateListener(({\n      editorState\n    }) => {\n      editorState.read(() => {\n        const root = $getRoot();\n        const text = root.getTextContent();\n        onChange(text);\n      });\n    });\n  }, [editor, onChange]);\n  return null;\n}\n\n// Markdown shortcuts plugin\n_s(CustomOnChangePlugin, \"mCqe7sh4aC9mLBXPHfG3d/PNTaQ=\", false, function () {\n  return [useLexicalComposerContext];\n});\n_c = CustomOnChangePlugin;\nfunction MarkdownShortcutsPlugin() {\n  _s2();\n  const [editor] = useLexicalComposerContext();\n  useEffect(() => {\n    return editor.registerUpdateListener(({\n      editorState,\n      dirtyElements\n    }) => {\n      if (dirtyElements.size === 0) return;\n      editorState.read(() => {\n        const selection = $getSelection();\n        if (!$isRangeSelection(selection)) return;\n        const text = selection.getTextContent();\n\n        // Handle markdown shortcuts\n        if (text.startsWith('**') && text.endsWith('**') && text.length > 4) {\n          editor.update(() => {\n            const newSelection = $getSelection();\n            if ($isRangeSelection(newSelection)) {\n              const cleanText = text.slice(2, -2);\n              newSelection.insertText(cleanText);\n              newSelection.formatText('bold');\n            }\n          });\n        } else if (text.startsWith('*') && text.endsWith('*') && text.length > 2) {\n          editor.update(() => {\n            const newSelection = $getSelection();\n            if ($isRangeSelection(newSelection)) {\n              const cleanText = text.slice(1, -1);\n              newSelection.insertText(cleanText);\n              newSelection.formatText('italic');\n            }\n          });\n        } else if (text.startsWith('~') && text.endsWith('~') && text.length > 2) {\n          editor.update(() => {\n            const newSelection = $getSelection();\n            if ($isRangeSelection(newSelection)) {\n              const cleanText = text.slice(1, -1);\n              newSelection.insertText(cleanText);\n              newSelection.formatText('underline');\n            }\n          });\n        } else if (text.startsWith('# ')) {\n          editor.update(() => {\n            const newSelection = $getSelection();\n            if ($isRangeSelection(newSelection)) {\n              const cleanText = text.slice(2);\n              newSelection.insertText(cleanText);\n              // Apply header formatting (simplified - just make it bold and larger)\n              newSelection.formatText('bold');\n            }\n          });\n        } else if (text.startsWith('## ')) {\n          editor.update(() => {\n            const newSelection = $getSelection();\n            if ($isRangeSelection(newSelection)) {\n              const cleanText = text.slice(3);\n              newSelection.insertText(cleanText);\n              newSelection.formatText('bold');\n            }\n          });\n        } else if (text.startsWith('### ')) {\n          editor.update(() => {\n            const newSelection = $getSelection();\n            if ($isRangeSelection(newSelection)) {\n              const cleanText = text.slice(4);\n              newSelection.insertText(cleanText);\n              newSelection.formatText('bold');\n            }\n          });\n        }\n      });\n    });\n  }, [editor]);\n  return null;\n}\n\n// Toolbar component\n_s2(MarkdownShortcutsPlugin, \"mCqe7sh4aC9mLBXPHfG3d/PNTaQ=\", false, function () {\n  return [useLexicalComposerContext];\n});\n_c2 = MarkdownShortcutsPlugin;\nfunction ToolbarPlugin() {\n  _s3();\n  const [editor] = useLexicalComposerContext();\n  const formatText = format => {\n    editor.update(() => {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection)) {\n        selection.formatText(format);\n      }\n    });\n  };\n  const formatHeader = level => {\n    editor.update(() => {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection)) {\n        // For now, just make headers bold\n        // In a full implementation, you'd create proper header nodes\n        selection.formatText('bold');\n      }\n    });\n  };\n  const alignText = alignment => {\n    editor.update(() => {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection)) {\n        // For now, just insert alignment markers\n        // In a full implementation, you'd set proper CSS alignment\n        const marker = alignment === 'left' ? '' : alignment === 'center' ? ' [CENTER] ' : ' [RIGHT] ';\n        selection.insertText(marker);\n      }\n    });\n  };\n  const insertLink = () => {\n    const url = prompt('Enter URL:');\n    if (url) {\n      const linkText = prompt('Enter link text (optional):', url);\n      const displayText = linkText || url;\n      editor.update(() => {\n        const selection = $getSelection();\n        if ($isRangeSelection(selection)) {\n          // Create markdown-style link\n          const markdownLink = `[${displayText}](${url})`;\n          selection.insertText(markdownLink);\n        }\n      });\n    }\n  };\n  const toggleList = () => {\n    editor.update(() => {\n      const selection = $getSelection();\n      if ($isRangeSelection(selection)) {\n        // Simple list implementation - just add bullet points\n        const text = selection.getTextContent();\n        const lines = text.split('\\n');\n        const formattedLines = lines.map(line => `• ${line}`);\n        selection.insertText(formattedLines.join('\\n'));\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex items-center gap-2 p-2 border-b border-gray-200 bg-gray-50\",\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => formatText('bold'),\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Bold (Ctrl+B)\",\n      children: /*#__PURE__*/_jsxDEV(Bold, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => formatText('italic'),\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Italic (Ctrl+I)\",\n      children: /*#__PURE__*/_jsxDEV(Italic, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => formatText('underline'),\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Underline (Ctrl+U)\",\n      children: /*#__PURE__*/_jsxDEV(Underline, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-px h-6 bg-gray-300\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => formatHeader(1),\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Heading 1 (# )\",\n      children: /*#__PURE__*/_jsxDEV(Heading1, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => formatHeader(2),\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Heading 2 (## )\",\n      children: /*#__PURE__*/_jsxDEV(Heading2, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => formatHeader(3),\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Heading 3 (### )\",\n      children: /*#__PURE__*/_jsxDEV(Heading3, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-px h-6 bg-gray-300\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => alignText('left'),\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Align Left\",\n      children: /*#__PURE__*/_jsxDEV(AlignLeft, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => alignText('center'),\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Align Center\",\n      children: /*#__PURE__*/_jsxDEV(AlignCenter, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: () => alignText('right'),\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Align Right\",\n      children: /*#__PURE__*/_jsxDEV(AlignRight, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-px h-6 bg-gray-300\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: toggleList,\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Bullet List\",\n      children: /*#__PURE__*/_jsxDEV(List, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: insertLink,\n      className: \"p-2 hover:bg-gray-200 rounded\",\n      title: \"Insert Link\",\n      children: /*#__PURE__*/_jsxDEV(Link, {\n        className: \"w-4 h-4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 182,\n    columnNumber: 5\n  }, this);\n}\n\n// Smart URL detection plugin\n_s3(ToolbarPlugin, \"MUJTZ3t3NKyXWeKoJUbyWHO70Z4=\", false, function () {\n  return [useLexicalComposerContext];\n});\n_c3 = ToolbarPlugin;\nfunction SmartURLDetectionPlugin() {\n  _s4();\n  const [editor] = useLexicalComposerContext();\n  useEffect(() => {\n    return editor.registerUpdateListener(({\n      editorState,\n      dirtyElements\n    }) => {\n      if (dirtyElements.size === 0) return;\n      editorState.read(() => {\n        const selection = $getSelection();\n        if (!$isRangeSelection(selection)) return;\n        const text = selection.getTextContent();\n\n        // URL regex pattern - matches http/https URLs and www. URLs\n        const urlRegex = /((https?:\\/\\/[^\\s]+)|(www\\.[^\\s]+\\.[^\\s]+))/g;\n        const matches = text.match(urlRegex);\n        if (matches && matches.length > 0) {\n          // Check if we have unformatted URLs\n          const hasUnformattedUrls = matches.some(url => {\n            // Check if the URL is not already in markdown link format\n            return !text.includes(`[${url}]`) && !text.includes(`[${url.split('/').pop()}]`);\n          });\n          if (hasUnformattedUrls) {\n            editor.update(() => {\n              const newSelection = $getSelection();\n              if ($isRangeSelection(newSelection)) {\n                // Get the current text again\n                const currentText = newSelection.getTextContent();\n\n                // Replace URLs with markdown-style links\n                let formattedText = currentText;\n                matches.forEach(url => {\n                  // Only format if it's not already formatted\n                  if (!formattedText.includes(`[${url}]`)) {\n                    // Prepend https:// if it's a www. URL\n                    const fullUrl = url.startsWith('www.') ? `https://${url}` : url;\n                    // Create a shorter display text for the link\n                    const displayText = url.length > 50 ? url.substring(0, 47) + '...' : url;\n                    formattedText = formattedText.replace(url, `[${displayText}](${fullUrl})`);\n                  }\n                });\n                if (formattedText !== currentText) {\n                  // Replace the entire selection with formatted text\n                  newSelection.insertText(formattedText);\n                }\n              }\n            });\n          }\n        }\n      });\n    });\n  }, [editor]);\n  return null;\n}\n\n// Error boundary component\n_s4(SmartURLDetectionPlugin, \"mCqe7sh4aC9mLBXPHfG3d/PNTaQ=\", false, function () {\n  return [useLexicalComposerContext];\n});\n_c4 = SmartURLDetectionPlugin;\nfunction ErrorBoundary({\n  children\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 350,\n    columnNumber: 10\n  }, this);\n}\n_c5 = ErrorBoundary;\nconst RichTextEditor = ({\n  value,\n  onChange,\n  placeholder = \"Start writing...\",\n  className = \"\"\n}) => {\n  const initialConfig = {\n    namespace: 'BeedooRichTextEditor',\n    theme: {\n      root: 'outline-none min-h-[200px] p-4',\n      text: {\n        bold: 'font-bold',\n        italic: 'italic',\n        underline: 'underline'\n      }\n    },\n    onError: error => {\n      console.error('Lexical error:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `border border-gray-300 rounded-md ${className}`,\n    children: /*#__PURE__*/_jsxDEV(LexicalComposer, {\n      initialConfig: initialConfig,\n      children: [/*#__PURE__*/_jsxDEV(ToolbarPlugin, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative\",\n        children: [/*#__PURE__*/_jsxDEV(RichTextPlugin, {\n          contentEditable: /*#__PURE__*/_jsxDEV(ContentEditable, {\n            className: \"outline-none min-h-[200px] p-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 381,\n            columnNumber: 15\n          }, this),\n          placeholder: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"absolute top-4 left-4 text-gray-400 pointer-events-none\",\n            children: placeholder\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 386,\n            columnNumber: 15\n          }, this),\n          ErrorBoundary: ErrorBoundary\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CustomOnChangePlugin, {\n          onChange: onChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(MarkdownShortcutsPlugin, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 393,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(SmartURLDetectionPlugin, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(HistoryPlugin, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(AutoFocusPlugin, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 396,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 375,\n    columnNumber: 5\n  }, this);\n};\n_c6 = RichTextEditor;\nexport default RichTextEditor;\nvar _c, _c2, _c3, _c4, _c5, _c6;\n$RefreshReg$(_c, \"CustomOnChangePlugin\");\n$RefreshReg$(_c2, \"MarkdownShortcutsPlugin\");\n$RefreshReg$(_c3, \"ToolbarPlugin\");\n$RefreshReg$(_c4, \"SmartURLDetectionPlugin\");\n$RefreshReg$(_c5, \"ErrorBoundary\");\n$RefreshReg$(_c6, \"RichTextEditor\");","map":{"version":3,"names":["React","useEffect","LexicalComposer","RichTextPlugin","ContentEditable","HistoryPlugin","AutoFocusPlugin","useLexicalComposerContext","$getRoot","$getSelection","$isRangeSelection","Bold","Italic","Underline","List","Link","AlignLeft","AlignCenter","AlignRight","Heading1","Heading2","Heading3","jsxDEV","_jsxDEV","IMAGE_UPLOAD_ENDPOINT","CustomOnChangePlugin","onChange","_s","editor","registerUpdateListener","editorState","read","root","text","getTextContent","_c","MarkdownShortcutsPlugin","_s2","dirtyElements","size","selection","startsWith","endsWith","length","update","newSelection","cleanText","slice","insertText","formatText","_c2","ToolbarPlugin","_s3","format","formatHeader","level","alignText","alignment","marker","insertLink","url","prompt","linkText","displayText","markdownLink","toggleList","lines","split","formattedLines","map","line","join","className","children","type","onClick","title","fileName","_jsxFileName","lineNumber","columnNumber","_c3","SmartURLDetectionPlugin","_s4","urlRegex","matches","match","hasUnformattedUrls","some","includes","pop","currentText","formattedText","forEach","fullUrl","substring","replace","_c4","ErrorBoundary","_c5","RichTextEditor","value","placeholder","initialConfig","namespace","theme","bold","italic","underline","onError","error","console","contentEditable","_c6","$RefreshReg$"],"sources":["C:/Code/beedoo/src/components/RichTextEditor.tsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport { LexicalComposer } from '@lexical/react/LexicalComposer';\r\nimport { RichTextPlugin } from '@lexical/react/LexicalRichTextPlugin';\r\nimport { ContentEditable } from '@lexical/react/LexicalContentEditable';\r\nimport { HistoryPlugin } from '@lexical/react/LexicalHistoryPlugin';\r\nimport { AutoFocusPlugin } from '@lexical/react/LexicalAutoFocusPlugin';\r\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext';\r\nimport { $getRoot, $getSelection, $isRangeSelection, $createTextNode, $isElementNode } from 'lexical';\r\nimport { Bold, Italic, Underline, List, Link, AlignLeft, AlignCenter, AlignRight, Heading1, Heading2, Heading3 } from 'lucide-react';\r\n\r\ninterface RichTextEditorProps {\r\n  value: string;\r\n  onChange: (value: string) => void;\r\n  placeholder?: string;\r\n  className?: string;\r\n}\r\n\r\nconst IMAGE_UPLOAD_ENDPOINT = '/.netlify/functions/upload-image';\r\n\r\n// Custom onChange plugin\r\nfunction CustomOnChangePlugin({ onChange }: { onChange: (value: string) => void }): JSX.Element | null {\r\n  const [editor] = useLexicalComposerContext();\r\n\r\n  useEffect(() => {\r\n    return editor.registerUpdateListener(({ editorState }) => {\r\n      editorState.read(() => {\r\n        const root = $getRoot();\r\n        const text = root.getTextContent();\r\n        onChange(text);\r\n      });\r\n    });\r\n  }, [editor, onChange]);\r\n\r\n  return null;\r\n}\r\n\r\n// Markdown shortcuts plugin\r\nfunction MarkdownShortcutsPlugin(): JSX.Element | null {\r\n  const [editor] = useLexicalComposerContext();\r\n\r\n  useEffect(() => {\r\n    return editor.registerUpdateListener(({ editorState, dirtyElements }) => {\r\n      if (dirtyElements.size === 0) return;\r\n\r\n      editorState.read(() => {\r\n        const selection = $getSelection();\r\n        if (!$isRangeSelection(selection)) return;\r\n\r\n        const text = selection.getTextContent();\r\n        \r\n        // Handle markdown shortcuts\r\n        if (text.startsWith('**') && text.endsWith('**') && text.length > 4) {\r\n          editor.update(() => {\r\n            const newSelection = $getSelection();\r\n            if ($isRangeSelection(newSelection)) {\r\n              const cleanText = text.slice(2, -2);\r\n              newSelection.insertText(cleanText);\r\n              newSelection.formatText('bold');\r\n            }\r\n          });\r\n        } else if (text.startsWith('*') && text.endsWith('*') && text.length > 2) {\r\n          editor.update(() => {\r\n            const newSelection = $getSelection();\r\n            if ($isRangeSelection(newSelection)) {\r\n              const cleanText = text.slice(1, -1);\r\n              newSelection.insertText(cleanText);\r\n              newSelection.formatText('italic');\r\n            }\r\n          });\r\n        } else if (text.startsWith('~') && text.endsWith('~') && text.length > 2) {\r\n          editor.update(() => {\r\n            const newSelection = $getSelection();\r\n            if ($isRangeSelection(newSelection)) {\r\n              const cleanText = text.slice(1, -1);\r\n              newSelection.insertText(cleanText);\r\n              newSelection.formatText('underline');\r\n            }\r\n          });\r\n        } else if (text.startsWith('# ')) {\r\n          editor.update(() => {\r\n            const newSelection = $getSelection();\r\n            if ($isRangeSelection(newSelection)) {\r\n              const cleanText = text.slice(2);\r\n              newSelection.insertText(cleanText);\r\n              // Apply header formatting (simplified - just make it bold and larger)\r\n              newSelection.formatText('bold');\r\n            }\r\n          });\r\n        } else if (text.startsWith('## ')) {\r\n          editor.update(() => {\r\n            const newSelection = $getSelection();\r\n            if ($isRangeSelection(newSelection)) {\r\n              const cleanText = text.slice(3);\r\n              newSelection.insertText(cleanText);\r\n              newSelection.formatText('bold');\r\n            }\r\n          });\r\n        } else if (text.startsWith('### ')) {\r\n          editor.update(() => {\r\n            const newSelection = $getSelection();\r\n            if ($isRangeSelection(newSelection)) {\r\n              const cleanText = text.slice(4);\r\n              newSelection.insertText(cleanText);\r\n              newSelection.formatText('bold');\r\n            }\r\n          });\r\n        }\r\n      });\r\n    });\r\n  }, [editor]);\r\n\r\n  return null;\r\n}\r\n\r\n// Toolbar component\r\nfunction ToolbarPlugin(): JSX.Element {\r\n  const [editor] = useLexicalComposerContext();\r\n\r\n  const formatText = (format: 'bold' | 'italic' | 'underline') => {\r\n    editor.update(() => {\r\n      const selection = $getSelection();\r\n      if ($isRangeSelection(selection)) {\r\n        selection.formatText(format);\r\n      }\r\n    });\r\n  };\r\n\r\n  const formatHeader = (level: 1 | 2 | 3) => {\r\n    editor.update(() => {\r\n      const selection = $getSelection();\r\n      if ($isRangeSelection(selection)) {\r\n        // For now, just make headers bold\r\n        // In a full implementation, you'd create proper header nodes\r\n        selection.formatText('bold');\r\n      }\r\n    });\r\n  };\r\n\r\n  const alignText = (alignment: 'left' | 'center' | 'right') => {\r\n    editor.update(() => {\r\n      const selection = $getSelection();\r\n      if ($isRangeSelection(selection)) {\r\n        // For now, just insert alignment markers\r\n        // In a full implementation, you'd set proper CSS alignment\r\n        const marker = alignment === 'left' ? '' : alignment === 'center' ? ' [CENTER] ' : ' [RIGHT] ';\r\n        selection.insertText(marker);\r\n      }\r\n    });\r\n  };\r\n\r\n  const insertLink = () => {\r\n    const url = prompt('Enter URL:');\r\n    if (url) {\r\n      const linkText = prompt('Enter link text (optional):', url);\r\n      const displayText = linkText || url;\r\n      \r\n      editor.update(() => {\r\n        const selection = $getSelection();\r\n        if ($isRangeSelection(selection)) {\r\n          // Create markdown-style link\r\n          const markdownLink = `[${displayText}](${url})`;\r\n          selection.insertText(markdownLink);\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  const toggleList = () => {\r\n    editor.update(() => {\r\n      const selection = $getSelection();\r\n      if ($isRangeSelection(selection)) {\r\n        // Simple list implementation - just add bullet points\r\n        const text = selection.getTextContent();\r\n        const lines = text.split('\\n');\r\n        const formattedLines = lines.map(line => `• ${line}`);\r\n        selection.insertText(formattedLines.join('\\n'));\r\n      }\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-2 p-2 border-b border-gray-200 bg-gray-50\">\r\n      {/* Text Formatting */}\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => formatText('bold')}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Bold (Ctrl+B)\"\r\n      >\r\n        <Bold className=\"w-4 h-4\" />\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => formatText('italic')}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Italic (Ctrl+I)\"\r\n      >\r\n        <Italic className=\"w-4 h-4\" />\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => formatText('underline')}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Underline (Ctrl+U)\"\r\n      >\r\n        <Underline className=\"w-4 h-4\" />\r\n      </button>\r\n      \r\n      <div className=\"w-px h-6 bg-gray-300\" />\r\n      \r\n      {/* Headers */}\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => formatHeader(1)}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Heading 1 (# )\"\r\n      >\r\n        <Heading1 className=\"w-4 h-4\" />\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => formatHeader(2)}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Heading 2 (## )\"\r\n      >\r\n        <Heading2 className=\"w-4 h-4\" />\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => formatHeader(3)}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Heading 3 (### )\"\r\n      >\r\n        <Heading3 className=\"w-4 h-4\" />\r\n      </button>\r\n      \r\n      <div className=\"w-px h-6 bg-gray-300\" />\r\n      \r\n      {/* Alignment */}\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => alignText('left')}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Align Left\"\r\n      >\r\n        <AlignLeft className=\"w-4 h-4\" />\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => alignText('center')}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Align Center\"\r\n      >\r\n        <AlignCenter className=\"w-4 h-4\" />\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => alignText('right')}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Align Right\"\r\n      >\r\n        <AlignRight className=\"w-4 h-4\" />\r\n      </button>\r\n      \r\n      <div className=\"w-px h-6 bg-gray-300\" />\r\n      \r\n      {/* Lists and Links */}\r\n      <button\r\n        type=\"button\"\r\n        onClick={toggleList}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Bullet List\"\r\n      >\r\n        <List className=\"w-4 h-4\" />\r\n      </button>\r\n      <button\r\n        type=\"button\"\r\n        onClick={insertLink}\r\n        className=\"p-2 hover:bg-gray-200 rounded\"\r\n        title=\"Insert Link\"\r\n      >\r\n        <Link className=\"w-4 h-4\" />\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Smart URL detection plugin\r\nfunction SmartURLDetectionPlugin(): JSX.Element | null {\r\n  const [editor] = useLexicalComposerContext();\r\n\r\n  useEffect(() => {\r\n    return editor.registerUpdateListener(({ editorState, dirtyElements }) => {\r\n      if (dirtyElements.size === 0) return;\r\n\r\n      editorState.read(() => {\r\n        const selection = $getSelection();\r\n        if (!$isRangeSelection(selection)) return;\r\n\r\n        const text = selection.getTextContent();\r\n        \r\n        // URL regex pattern - matches http/https URLs and www. URLs\r\n        const urlRegex = /((https?:\\/\\/[^\\s]+)|(www\\.[^\\s]+\\.[^\\s]+))/g;\r\n        const matches = text.match(urlRegex);\r\n        \r\n        if (matches && matches.length > 0) {\r\n          // Check if we have unformatted URLs\r\n          const hasUnformattedUrls = matches.some(url => {\r\n            // Check if the URL is not already in markdown link format\r\n            return !text.includes(`[${url}]`) && !text.includes(`[${url.split('/').pop()}]`);\r\n          });\r\n\r\n          if (hasUnformattedUrls) {\r\n            editor.update(() => {\r\n              const newSelection = $getSelection();\r\n              if ($isRangeSelection(newSelection)) {\r\n                // Get the current text again\r\n                const currentText = newSelection.getTextContent();\r\n                \r\n                // Replace URLs with markdown-style links\r\n                let formattedText = currentText;\r\n                matches.forEach(url => {\r\n                  // Only format if it's not already formatted\r\n                  if (!formattedText.includes(`[${url}]`)) {\r\n                    // Prepend https:// if it's a www. URL\r\n                    const fullUrl = url.startsWith('www.') ? `https://${url}` : url;\r\n                    // Create a shorter display text for the link\r\n                    const displayText = url.length > 50 ? url.substring(0, 47) + '...' : url;\r\n                    formattedText = formattedText.replace(url, `[${displayText}](${fullUrl})`);\r\n                  }\r\n                });\r\n                \r\n                if (formattedText !== currentText) {\r\n                  // Replace the entire selection with formatted text\r\n                  newSelection.insertText(formattedText);\r\n                }\r\n              }\r\n            });\r\n          }\r\n        }\r\n      });\r\n    });\r\n  }, [editor]);\r\n\r\n  return null;\r\n}\r\n\r\n// Error boundary component\r\nfunction ErrorBoundary({ children }: { children: React.ReactNode }): JSX.Element {\r\n  return <div>{children}</div>;\r\n}\r\n\r\nconst RichTextEditor: React.FC<RichTextEditorProps> = ({ \r\n  value, \r\n  onChange, \r\n  placeholder = \"Start writing...\",\r\n  className = \"\"\r\n}) => {\r\n  const initialConfig = {\r\n    namespace: 'BeedooRichTextEditor',\r\n    theme: {\r\n      root: 'outline-none min-h-[200px] p-4',\r\n      text: {\r\n        bold: 'font-bold',\r\n        italic: 'italic',\r\n        underline: 'underline',\r\n      },\r\n    },\r\n    onError: (error: Error) => {\r\n      console.error('Lexical error:', error);\r\n    },\r\n  };\r\n\r\n  return (\r\n    <div className={`border border-gray-300 rounded-md ${className}`}>\r\n      <LexicalComposer initialConfig={initialConfig}>\r\n        <ToolbarPlugin />\r\n        <div className=\"relative\">\r\n          <RichTextPlugin\r\n            contentEditable={\r\n              <ContentEditable \r\n                className=\"outline-none min-h-[200px] p-4\"\r\n              />\r\n            }\r\n            placeholder={\r\n              <div className=\"absolute top-4 left-4 text-gray-400 pointer-events-none\">\r\n                {placeholder}\r\n              </div>\r\n            }\r\n            ErrorBoundary={ErrorBoundary}\r\n          />\r\n          <CustomOnChangePlugin onChange={onChange} />\r\n          <MarkdownShortcutsPlugin />\r\n          <SmartURLDetectionPlugin />\r\n          <HistoryPlugin />\r\n          <AutoFocusPlugin />\r\n        </div>\r\n      </LexicalComposer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RichTextEditor; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}